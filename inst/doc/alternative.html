<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>The alternative hypothesis in permutation testing</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>






<style type="text/css">
/* for pandoc --citeproc since 2.11 */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">The alternative hypothesis in permutation
testing</h1>



<p>In this article, we discuss a key difference between the traditional
framework for null hypothesis significance testing (NHST) and the
permutation framework for NHST. This critical difference lies at the
root of the framework in the specification of the null and alternative
hypothesis. First, we review the traditional approach to NHST. Second we
explain how the use of the permutation framework requires particular
care when formulating the null and alternative hypotheses. Finally, we
will discuss an approach proposed by <span class="citation">Pesarin and
Salmaso (2010)</span>, coined <strong>Non-Parametric
Combination</strong> (NPC), which allows one to combine several test
statistics into a single test.</p>
<div id="traditional-nhst" class="section level2">
<h2>Traditional NHST</h2>
<p>The traditional approach to NHST pertains to specifying a null
distribution <span class="math inline">\(H_0\)</span> that we would like
to reject in favor of an alternative hypothesis <span class="math inline">\(H_a\)</span> given statistical evidence in the
form of data samples. For example, if we study the effect of some drug
on the amount of sugar in the blood in patients diagnosed with diabetes,
we might take two samples out of two distinct populations, one to which
we gave a placebo and one to which we gave the treatment. At this point,
the goal is to show that the average amount of sugar in the treatment
group is lower than the one in the placebo group. Hence, a suitable test
for answering this question is given by the following hypotheses:</p>
<p><span class="math display">\[
H_0: \mu_\mathrm{treatment} \ge \mu_\mathrm{placebo} \quad
\mbox{against} \quad H_a: \mu_\mathrm{treatment} &lt;
\mu_\mathrm{placebo}
\]</span></p>
<p>As suggested by intuition, the alternative hypothesis is first
determined on the basis of what we aim at proving and the null
hypothesis <span class="math inline">\(H_0\)</span> is then deduced as
the complementary event to <span class="math inline">\(H_a\)</span>.</p>
</div>
<div id="permutation-nhst" class="section level2">
<h2>Permutation NHST</h2>
<p>The permutation framework completely redefines the null and
alternative hypotheses with respect to the traditional approach:</p>
<ul>
<li>The null hypothesis is <strong>always the same</strong> for all
tests performed in the permutation framework. This is by design. In
effect, the idea of using the permutations to approach the null
distribution relies on the assumption of data exchangeability under
<span class="math inline">\(H_0\)</span>. This means that the null
hypothesis always needs to be that the two samples are drawn from the
same underlying distribution. Hence, if we have two independent samples
<span class="math inline">\(X_1, \dots, X_{n_x} \stackrel{i.i.d.}{\sim}
F_X\)</span> and <span class="math inline">\(Y_1, \dots, Y_{n_y}
\stackrel{i.i.d.}{\sim} F_Y\)</span>, the null hypothesis for the
two-sample problem is necessarily: <span class="math display">\[ H_0:
F_X = F_Y. \]</span></li>
<li>The alternative hypothesis <strong>is not</strong> the complementary
event to <span class="math inline">\(H_0\)</span>. In effect, that would
be <span class="math inline">\(F_X \neq F_Y\)</span>. However, there
could be millions of reasons for that to be true. In practice, the use
of a specific test statistic targets some aspect(s) of the
distributions. For instance, if one uses Hotelling’s <span class="math inline">\(T^2\)</span> statistic, focus is put on finding
differences in the first-order moment of the two distributions <span class="math inline">\(F_X\)</span> and <span class="math inline">\(F_Y\)</span>.</li>
<li>These two differences generate a huge change of paradigm for
interpreting the results. In effect, suppose that the permutation test
using Hotelling’s <span class="math inline">\(T^2\)</span> statistic
reveals that there is not enough evidence to reject the null hypothesis.
This does not imply, by no means, that we can assume that the two
samples come from the same distribution, because, for all we know, our
data could contain enough evidence to identify differences in variance
or higher moments.</li>
</ul>
</div>
<div id="non-parametric-combination" class="section level2">
<h2>Non-Parametric Combination</h2>
<p>Once you have your sample of <span class="math inline">\(m\)</span>
permutations out the <span class="math inline">\(m_t\)</span> possible
ones, you can in fact compute the values of as many test statistics
<span class="math inline">\(T^{(1)}, \dots, T^{(L)}\)</span> as you
want. At this point, you might want to use the unbiased estimator <span class="math inline">\(\widehat{p_\infty}^{(\ell)} =
\frac{B^{(\ell)}}{m}\)</span> of the p-value <span class="math inline">\(p_\infty^{(\ell)} = \mathbb{P} \left( T^{(\ell)}
\ge t_\mathrm{obs}^{(\ell)} \right)\)</span> for each test statistic to
produce <span class="math inline">\(L\)</span> p-value estimates, each
one targeting a different aspect of the distributions under
investigation. Since this evidence has been summarized by p-values, they
are all on the same scale even though they might look at very different
features of the distributions. They can therefore be combined in various
ways to provide a single test statistic value to be used in the testing
procedure. There are several possible <strong>combining
functions</strong> to do this fusion of p-values. The package
<strong>flipr</strong> currently implements:</p>
<ul>
<li>Tippett’s combining function: <span class="math inline">\(\mathrm{Tippett}(p_1, …, p_L) = 1 - \min_{\ell \in
1, \dots, L} p_\ell\)</span>; and,</li>
<li>Fisher’s combining function: <span class="math inline">\(\mathrm{Fisher}(p_1, …, p_L) = -2 \sum_{\ell=1}^L
\log p_\ell\)</span>.</li>
</ul>
<p>The choice of the combining function is made through the optional
argument <code>combining_function</code> which takes a string as value.
At the moment, it accepts either <code>&quot;tippett&quot;</code> or
<code>&quot;fisher&quot;</code> for picking one of the two above-mentioned
combining functions.</p>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="unnumbered">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-pesarin2010" class="csl-entry">
Pesarin, Fortunato, and Luigi Salmaso. 2010. <span>“Permutation Tests
for Complex Data,”</span> March. <a href="https://doi.org/10.1002/9780470689516">https://doi.org/10.1002/9780470689516</a>.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
